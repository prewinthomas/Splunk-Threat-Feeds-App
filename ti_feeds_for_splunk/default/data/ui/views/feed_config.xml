<dashboard>
  <label>Threat Feed Collector Settings</label>
  <description>Enable/disable the feed collector and adjust its interval.</description>

  <!-- Show current status -->
  <row>
    <panel>
      <title>Current Input Status</title>
      <table>
        <search>
          <query>
            | rest /servicesNS/nobody/ti_feeds_for_splunk/data/inputs/script
            | search title="*fetch_feeds.py"
            | table title disabled interval
          </query>
        </search>
      </table>
    </panel>
  </row>

  <!-- Form to update -->
  <row>
    <panel>
      <title>Update Settings</title>
      <form>
        <input type="dropdown" token="disabled">
          <label>Enable/Disable</label>
          <choice value="0">Enabled</choice>
          <choice value="1">Disabled</choice>
          <default>0</default>
        </input>
        <input type="text" token="interval">
          <label>Interval (seconds)</label>
          <default>900</default>
        </input>
        <button label="Apply Changes">
          <action>
            <eval token="update">
              "| rest /servicesNS/nobody/ti_feeds_for_splunk/data/inputs/script \
              splunk_server=local \
              title=\"`fetch_feeds.py`\" \
              disabled=$disabled$ interval=$interval$"
            </eval>
          </action>
        </button>
      </form>
    </panel>
  </row>
</dashboard>
